/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

buildscript {
    dependencies {
        classpath 'gradle.plugin.org.jetbrains.gradle.plugin.idea-ext:gradle-idea-ext:1.0'
        classpath 'name.remal:gradle-plugins:1.3.1'
    }
    repositories {
        gradlePluginPortal()
        mavenCentral()
    }
}

plugins {
    id 'java-gradle-plugin'
    id 'com.gradle.plugin-publish' version '0.14.0'
}

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

allprojects {
    group = 'name.remal.gradle-plugins'
    version = '0-SNAPSHOT'
}

apply from: 'gradle/properties.gradle'
apply from: 'gradle/ci.gradle'
apply from: 'gradle/dependencies.gradle'
apply from: 'gradle/java.gradle'
apply from: 'gradle/groovy.gradle'
apply from: 'gradle/checkstyle.gradle'
apply from: 'gradle/ide.gradle'

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

dependencies {
    //compileOnly 'com.gradle.publish:plugin-publish-plugin:0.14.0'
}

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

gradlePlugin {
    plugins {
        templatePlugin {
            id = 'name.remal.template-plugin.v2'
            implementationClass = 'name.remal.gradleplugins.template.v2.TemplatePlugin'
        }
    }
}

pluginBundle.with {
    it.website = property('repository-html-url') // FIXME: use real website URL here
    it.vcsUrl = property('repository-html-url')
    it.description = property('repository-description') // FIXME: use real description here
    it.tags = property('repository-topics').toString().split(',')
        .collect { it.trim() }
        .findAll { !it.isEmpty() }

    it.plugins {
        templatePlugin {
            displayName = property('repository-description') // FIXME: use real name here
        }
    }
}
